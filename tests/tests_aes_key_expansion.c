/*
** EPITECH PROJECT, 2021
** TESTS_AES_KEY_EXPANSION
** File description:
** Test aes_key_expansion
*/

#include <criterion/criterion.h>

#include "tests_aes.h"

#include "aes.h"
#include "aes_tools.h"

Test(gen_next_round_key, basic_1)
{
    aes_matrix_t prev_round_key = { { 48, 49, 50, 51 }, { 52, 53, 54, 55 },
        { 56, 57, 97, 98 }, { 99, 100, 101, 102 } };
    aes_matrix_t round_key;
    aes_matrix_t expected_round_key = { { 114, 124, 1, 200 },
        { 70, 73, 55, 255 }, { 126, 112, 86, 157 }, { 29, 20, 51, 251 } };

    gen_next_round_key(round_key, prev_round_key, 0x01);
    CHECK_MATRIX_EQUALITY(round_key, expected_round_key);
}

Test(gen_next_round_key, basic_2)
{
    aes_matrix_t prev_round_key = { { 114, 124, 1, 200 }, { 70, 73, 55, 255 },
        { 126, 112, 86, 157 }, { 29, 20, 51, 251 } };
    aes_matrix_t round_key;
    aes_matrix_t expected_round_key = { { 138, 191, 14, 108 },
        { 204, 246, 57, 147 }, { 178, 134, 111, 14 }, { 175, 146, 92, 245 } };

    gen_next_round_key(round_key, prev_round_key, 0x02);
    CHECK_MATRIX_EQUALITY(round_key, expected_round_key);
}

Test(gen_next_round_key, null_key_1)
{
    aes_matrix_t prev_round_key = { { 0, 0, 0, 0 }, { 0, 0, 0, 0 },
        { 0, 0, 0, 0 }, { 0, 0, 0, 0 } };
    aes_matrix_t round_key;
    aes_matrix_t expected_round_key = { { 98, 99, 99, 99 }, { 98, 99, 99, 99 },
        { 98, 99, 99, 99 }, { 98, 99, 99, 99 } };

    gen_next_round_key(round_key, prev_round_key, 0x01);
    CHECK_MATRIX_EQUALITY(round_key, expected_round_key);
}

Test(gen_next_round_key, null_key_2)
{
    aes_matrix_t prev_round_key = { { 98, 99, 99, 99 }, { 98, 99, 99, 99 },
        { 98, 99, 99, 99 }, { 98, 99, 99, 99 } };
    aes_matrix_t round_key;
    aes_matrix_t expected_round_key = { { 155, 152, 152, 201 },
        { 249, 251, 251, 170 }, { 155, 152, 152, 201 },
        { 249, 251, 251, 170 } };

    gen_next_round_key(round_key, prev_round_key, 0x02);
    CHECK_MATRIX_EQUALITY(round_key, expected_round_key);
}

static const uint8_t expected_rcons[] = { 0x01, 0x02, 0x04, 0x08, 0x10, 0x20,
    0x40, 0x80, 0x1B, 0x36, 0x6C, 0xD8, 0xAB, 0x4D, 0x9A, 0x2F, 0x5E, 0xBC,
    0x63, 0xC6, 0x97, 0x35, 0x6A, 0xD4, 0xB3, 0x7D, 0xFA, 0xEF, 0xC5, 0x91,
    0x39 };

Test(gen_next_rcon, basic)
{
    uint8_t rcon = AES_INIT_RCON;

    for (size_t k = 0; k < sizeof(expected_rcons); k++) {
        rcon = gen_next_rcon(rcon);
        cr_assert_eq(rcon, expected_rcons[k]);
    }
}

static const aes_expended_key_t expected_basic_128_expended_key = {
    { { 48, 49, 50, 51 }, { 52, 53, 54, 55 }, { 56, 57, 97, 98 },
        { 99, 100, 101, 102 } },
    { { 114, 124, 1, 200 }, { 70, 73, 55, 255 }, { 126, 112, 86, 157 },
        { 29, 20, 51, 251 } },
    { { 138, 191, 14, 108 }, { 204, 246, 57, 147 }, { 178, 134, 111, 14 },
        { 175, 146, 92, 245 } },
    { { 193, 245, 232, 21 }, { 13, 3, 209, 134 }, { 191, 133, 190, 136 },
        { 16, 23, 226, 125 } },
    { { 57, 109, 23, 223 }, { 52, 110, 198, 89 }, { 139, 235, 120, 209 },
        { 155, 252, 154, 172 } },
    { { 153, 213, 134, 203 }, { 173, 187, 64, 146 }, { 38, 80, 56, 67 },
        { 189, 172, 162, 239 } },
    { { 40, 239, 89, 177 }, { 133, 84, 25, 35 }, { 163, 4, 33, 96 },
        { 30, 168, 131, 143 } },
    { { 170, 3, 42, 195 }, { 47, 87, 51, 224 }, { 140, 83, 18, 128 },
        { 146, 251, 145, 15 } },
    { { 37, 130, 92, 140 }, { 10, 213, 111, 108 }, { 134, 134, 125, 236 },
        { 20, 125, 236, 227 } },
    { { 193, 76, 77, 118 }, { 203, 153, 34, 26 }, { 77, 31, 95, 246 },
        { 89, 98, 179, 21 } },
    { { 93, 33, 20, 189 }, { 150, 184, 54, 167 }, { 219, 167, 105, 81 },
        { 130, 197, 218, 68 } }
};

Test(aes_key_expansion, basic_128)
{
    aes_key128_t key = "0123456789abcdef";
    aes_expended_key_t round_keys;

    aes_key_expansion(round_keys, AES_128, key, AES128_NB_ROUNDS);
    for (int round = 0; round <= AES128_NB_ROUNDS; round++)
        CHECK_MATRIX_EQUALITY(
            round_keys[round], expected_basic_128_expended_key[round]);
}

static const aes_expended_key_t expected_basic_128_null_expended_key = {
    { { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } },
    { { 98, 99, 99, 99 }, { 98, 99, 99, 99 }, { 98, 99, 99, 99 },
        { 98, 99, 99, 99 } },
    { { 155, 152, 152, 201 }, { 249, 251, 251, 170 }, { 155, 152, 152, 201 },
        { 249, 251, 251, 170 } },
    { { 144, 151, 52, 80 }, { 105, 108, 207, 250 }, { 242, 244, 87, 51 },
        { 11, 15, 172, 153 } },
    { { 238, 6, 218, 123 }, { 135, 106, 21, 129 }, { 117, 158, 66, 178 },
        { 126, 145, 238, 43 } },
    { { 127, 46, 43, 136 }, { 248, 68, 62, 9 }, { 141, 218, 124, 187 },
        { 243, 75, 146, 144 } },
    { { 236, 97, 75, 133 }, { 20, 37, 117, 140 }, { 153, 255, 9, 55 },
        { 106, 180, 155, 167 } },
    { { 33, 117, 23, 135 }, { 53, 80, 98, 11 }, { 172, 175, 107, 60 },
        { 198, 27, 240, 155 } },
    { { 14, 249, 3, 51 }, { 59, 169, 97, 56 }, { 151, 6, 10, 4 },
        { 81, 29, 250, 159 } },
    { { 177, 212, 216, 226 }, { 138, 125, 185, 218 }, { 29, 123, 179, 222 },
        { 76, 102, 73, 65 } },
    { { 180, 239, 91, 203 }, { 62, 146, 226, 17 }, { 35, 233, 81, 207 },
        { 111, 143, 24, 142 } }
};

Test(aes_key_expansion, basic_128_null_key)
{
    aes_key128_t key = { 0 };
    aes_expended_key_t round_keys;

    aes_key_expansion(round_keys, AES_128, key, AES128_NB_ROUNDS);
    for (int round = 0; round <= AES128_NB_ROUNDS; round++)
        CHECK_MATRIX_EQUALITY(
            round_keys[round], expected_basic_128_null_expended_key[round]);
}

static const aes_expended_key_t expected_basic_192_expended_key = {
    { { 48, 49, 50, 51 }, { 52, 53, 54, 55 }, { 56, 57, 97, 98 },
        { 99, 100, 101, 102 } },
    { { 103, 104, 105, 106 }, { 107, 108, 109, 110 }, { 97, 13, 173, 76 },
        { 85, 56, 155, 123 } },
    { { 109, 1, 250, 25 }, { 14, 101, 159, 127 }, { 105, 13, 246, 21 },
        { 2, 97, 155, 123 } },
    { { 140, 25, 140, 59 }, { 217, 33, 23, 64 }, { 180, 32, 237, 89 },
        { 186, 69, 114, 38 } },
    { { 211, 72, 132, 51 }, { 209, 41, 31, 72 }, { 45, 217, 222, 5 },
        { 244, 248, 201, 69 } },
    { { 64, 216, 36, 28 }, { 250, 157, 86, 58 }, { 41, 213, 210, 9 },
        { 248, 252, 205, 65 } },
    { { 149, 100, 93, 68 }, { 97, 156, 148, 1 }, { 33, 68, 176, 29 },
        { 219, 217, 230, 39 } },
    { { 242, 12, 52, 46 }, { 10, 240, 249, 111 }, { 9, 253, 245, 35 },
        { 104, 97, 97, 34 } },
    { { 73, 37, 209, 63 }, { 146, 252, 55, 24 }, { 96, 240, 3, 54 },
        { 106, 0, 250, 89 } },
    { { 74, 208, 62, 33 }, { 34, 177, 95, 3 }, { 107, 148, 142, 60 },
        { 249, 104, 185, 36 } },
    { { 153, 152, 186, 18 }, { 243, 152, 64, 75 }, { 76, 217, 141, 44 },
        { 110, 104, 210, 47 } },
    { { 5, 252, 92, 19 }, { 252, 148, 229, 55 }, { 101, 12, 95, 37 },
        { 150, 148, 31, 110 } },
    { { 238, 25, 18, 188 }, { 128, 113, 192, 147 }, { 133, 141, 156, 128 },
        { 121, 25, 121, 183 } }
};

Test(aes_key_expansion, basic_192)
{
    aes_key192_t key = "0123456789abcdefghijklmn";
    aes_expended_key_t round_keys;

    aes_key_expansion(round_keys, AES_192, key, AES192_NB_ROUNDS);
    for (int round = 0; round <= AES192_NB_ROUNDS; round++)
        CHECK_MATRIX_EQUALITY(
            round_keys[round], expected_basic_192_expended_key[round]);
}

static const aes_expended_key_t expected_basic_192_null_expended_key = {
    { { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } },
    { { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 98, 99, 99, 99 }, { 98, 99, 99, 99 } },
    { { 98, 99, 99, 99 }, { 98, 99, 99, 99 }, { 98, 99, 99, 99 },
        { 98, 99, 99, 99 } },
    { { 155, 152, 152, 201 }, { 249, 251, 251, 170 }, { 155, 152, 152, 201 },
        { 249, 251, 251, 170 } },
    { { 155, 152, 152, 201 }, { 249, 251, 251, 170 }, { 144, 151, 52, 80 },
        { 105, 108, 207, 250 } },
    { { 242, 244, 87, 51 }, { 11, 15, 172, 153 }, { 144, 151, 52, 80 },
        { 105, 108, 207, 250 } },
    { { 200, 29, 25, 169 }, { 161, 113, 214, 83 }, { 83, 133, 129, 96 },
        { 88, 138, 45, 249 } },
    { { 200, 29, 25, 169 }, { 161, 113, 214, 83 }, { 123, 235, 244, 155 },
        { 218, 154, 34, 200 } },
    { { 137, 31, 163, 168 }, { 209, 149, 142, 81 }, { 25, 136, 151, 248 },
        { 184, 249, 65, 171 } },
    { { 194, 104, 150, 247 }, { 24, 242, 180, 63 }, { 145, 237, 23, 151 },
        { 64, 120, 153, 198 } },
    { { 89, 240, 14, 62 }, { 225, 9, 79, 149 }, { 131, 236, 188, 15 },
        { 155, 30, 8, 48 } },
    { { 10, 243, 31, 167 }, { 74, 139, 134, 97 }, { 19, 123, 136, 95 },
        { 242, 114, 199, 202 } },
    { { 67, 42, 200, 134 }, { 216, 52, 192, 182 }, { 210, 199, 223, 17 },
        { 152, 76, 89, 112 } }
};

Test(aes_key_expansion, basic_192_null_key)
{
    aes_key192_t key = { 0 };
    aes_expended_key_t round_keys;

    aes_key_expansion(round_keys, AES_192, key, AES192_NB_ROUNDS);
    for (int round = 0; round <= AES192_NB_ROUNDS; round++)
        CHECK_MATRIX_EQUALITY(
            round_keys[round], expected_basic_192_null_expended_key[round]);
}

static const aes_expended_key_t expected_basic_256_expended_key = {
    { { 48, 49, 50, 51 }, { 52, 53, 54, 55 }, { 56, 57, 97, 98 },
        { 99, 100, 101, 102 } },
    { { 103, 104, 105, 106 }, { 107, 108, 109, 110 }, { 111, 112, 113, 114 },
        { 115, 116, 117, 118 } },
    { { 163, 172, 10, 188 }, { 151, 153, 60, 139 }, { 175, 160, 93, 233 },
        { 204, 196, 56, 143 } },
    { { 44, 116, 110, 25 }, { 71, 24, 3, 119 }, { 40, 104, 114, 5 },
        { 91, 28, 7, 115 } },
    { { 61, 105, 133, 133 }, { 170, 240, 185, 14 }, { 5, 80, 228, 231 },
        { 201, 148, 220, 104 } },
    { { 241, 86, 232, 92 }, { 182, 78, 235, 43 }, { 158, 38, 153, 46 },
        { 197, 58, 158, 93 } },
    { { 185, 98, 201, 35 }, { 19, 146, 112, 45 }, { 22, 194, 148, 202 },
        { 223, 86, 72, 162 } },
    { { 111, 231, 186, 102 }, { 217, 169, 81, 77 }, { 71, 143, 200, 99 },
        { 130, 181, 86, 62 } },
    { { 100, 211, 123, 48 }, { 119, 65, 11, 29 }, { 97, 131, 159, 215 },
        { 190, 213, 215, 117 } },
    { { 193, 228, 180, 251 }, { 24, 77, 229, 182 }, { 95, 194, 45, 213 },
        { 221, 119, 123, 235 } },
    { { 129, 242, 146, 241 }, { 246, 179, 153, 236 }, { 151, 48, 6, 59 },
        { 41, 229, 209, 78 } },
    { { 100, 61, 138, 212 }, { 124, 112, 111, 98 }, { 35, 178, 66, 183 },
        { 254, 197, 57, 92 } },
    { { 7, 224, 216, 74 }, { 241, 83, 65, 166 }, { 102, 99, 71, 157 },
        { 79, 134, 150, 211 } },
    { { 224, 121, 26, 178 }, { 156, 9, 117, 208 }, { 191, 187, 55, 103 },
        { 65, 126, 14, 59 } },
    { { 180, 75, 58, 201 }, { 69, 24, 123, 111 }, { 35, 123, 60, 242 },
        { 108, 253, 170, 33 } }
};

Test(aes_key_expansion, basic_256)
{
    aes_key256_t key = "0123456789abcdefghijklmnopqrstuv";
    aes_expended_key_t round_keys;

    aes_key_expansion(round_keys, AES_256, key, AES256_NB_ROUNDS);
    for (int round = 0; round <= AES256_NB_ROUNDS; round++)
        CHECK_MATRIX_EQUALITY(
            round_keys[round], expected_basic_256_expended_key[round]);
}

static const aes_expended_key_t expected_basic_256_null_expended_key = {
    { { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } },
    { { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } },
    { { 98, 99, 99, 99 }, { 98, 99, 99, 99 }, { 98, 99, 99, 99 },
        { 98, 99, 99, 99 } },
    { { 170, 251, 251, 251 }, { 170, 251, 251, 251 }, { 170, 251, 251, 251 },
        { 170, 251, 251, 251 } },
    { { 111, 108, 108, 207 }, { 13, 15, 15, 172 }, { 111, 108, 108, 207 },
        { 13, 15, 15, 172 } },
    { { 125, 141, 141, 106 }, { 215, 118, 118, 145 }, { 125, 141, 141, 106 },
        { 215, 118, 118, 145 } },
    { { 83, 84, 237, 193 }, { 94, 91, 226, 109 }, { 49, 55, 142, 162 },
        { 60, 56, 129, 14 } },
    { { 150, 138, 129, 193 }, { 65, 252, 247, 80 }, { 60, 113, 122, 58 },
        { 235, 7, 12, 171 } },
    { { 158, 170, 143, 40 }, { 192, 241, 109, 69 }, { 241, 198, 227, 231 },
        { 205, 254, 98, 233 } },
    { { 43, 49, 43, 223 }, { 106, 205, 220, 143 }, { 86, 188, 166, 181 },
        { 189, 187, 170, 30 } },
    { { 100, 6, 253, 82 }, { 164, 247, 144, 23 }, { 85, 49, 115, 240 },
        { 152, 207, 17, 25 } },
    { { 109, 187, 169, 11 }, { 7, 118, 117, 132 }, { 81, 202, 211, 49 },
        { 236, 113, 121, 47 } },
    { { 231, 176, 232, 156 }, { 67, 71, 120, 139 }, { 22, 118, 11, 123 },
        { 142, 185, 26, 98 } },
    { { 116, 237, 11, 161 }, { 115, 155, 126, 37 }, { 34, 81, 173, 20 },
        { 206, 32, 212, 59 } },
    { { 16, 248, 10, 23 }, { 83, 191, 114, 156 }, { 69, 201, 121, 231 },
        { 203, 112, 99, 133 } }
};

Test(aes_key_expansion, basic_256_null_key)
{
    aes_key256_t key = { 0 };
    aes_expended_key_t round_keys;

    aes_key_expansion(round_keys, AES_256, key, AES256_NB_ROUNDS);
    for (int round = 0; round <= AES256_NB_ROUNDS; round++)
        CHECK_MATRIX_EQUALITY(
            round_keys[round], expected_basic_256_null_expended_key[round]);
}

static const aes_expended_key_t expected_basic_1024_expended_key = {
    { { 24, 69, 133, 57 }, { 186, 135, 172, 111 }, { 116, 80, 124, 156 },
        { 50, 233, 65, 146 } },
    { { 213, 55, 29, 103 }, { 46, 17, 14, 199 }, { 122, 39, 216, 4 },
        { 3, 241, 5, 58 } },
    { { 182, 2, 252, 100 }, { 36, 87, 195, 98 }, { 74, 66, 149, 14 },
        { 151, 47, 219, 81 } },
    { { 40, 4, 102, 100 }, { 11, 65, 189, 142 }, { 3, 27, 87, 87 },
        { 70, 184, 223, 198 } },
    { { 2, 2, 224, 232 }, { 10, 22, 205, 87 }, { 206, 117, 178, 9 },
        { 53, 109, 243, 53 } },
    { { 168, 209, 86, 45 }, { 9, 60, 4, 5 }, { 193, 79, 247, 145 },
        { 253, 64, 121, 148 } },
    { { 172, 90, 157, 30 }, { 38, 17, 214, 197 }, { 204, 74, 159, 139 },
        { 60, 36, 2, 55 } },
    { { 34, 11, 109, 182 }, { 218, 146, 91, 3 }, { 129, 92, 76, 189 },
        { 122, 191, 48, 118 } },
    { { 17, 65, 189, 227 }, { 171, 198, 17, 140 }, { 223, 150, 109, 16 },
        { 237, 127, 44, 130 } },
    { { 128, 229, 108, 116 }, { 174, 244, 98, 179 }, { 212, 211, 186, 183 },
        { 215, 34, 191, 141 } },
    { { 97, 32, 67, 233 }, { 69, 119, 128, 139 }, { 15, 53, 21, 133 },
        { 152, 26, 206, 212 } },
    { { 176, 30, 168, 176 }, { 187, 95, 21, 62 }, { 184, 68, 66, 105 },
        { 254, 252, 157, 175 } },
    { { 252, 254, 125, 71 }, { 246, 232, 176, 16 }, { 56, 157, 2, 25 },
        { 13, 240, 241, 44 } },
    { { 165, 33, 167, 1 }, { 172, 29, 163, 4 }, { 109, 82, 84, 149 },
        { 144, 18, 45, 1 } },
    { { 60, 72, 176, 31 }, { 26, 89, 102, 218 }, { 214, 19, 249, 81 },
        { 234, 55, 251, 102 } },
    { { 200, 60, 150, 208 }, { 18, 174, 205, 211 }, { 147, 242, 129, 110 },
        { 233, 77, 177, 24 } },
    { { 240, 137, 16, 253 }, { 91, 79, 1, 113 }, { 132, 217, 108, 97 },
        { 105, 166, 64, 227 } },
    { { 121, 193, 101, 101 }, { 215, 53, 7, 214 }, { 3, 230, 189, 97 },
        { 212, 196, 2, 236 } },
    { { 181, 228, 65, 5 }, { 240, 147, 193, 142 }, { 255, 166, 212, 11 },
        { 103, 188, 26, 223 } },
    { { 215, 162, 178, 111 }, { 108, 253, 167, 81 }, { 212, 185, 229, 56 },
        { 42, 69, 120, 151 } },
    { { 214, 187, 5, 208 }, { 32, 83, 181, 192 }, { 24, 206, 183, 217 },
        { 21, 62, 70, 245 } },
    { { 176, 31, 225, 244 }, { 28, 2, 66, 240 }, { 113, 80, 22, 101 },
        { 225, 66, 59, 100 } },
    { { 221, 10, 139, 123 }, { 199, 83, 237, 161 }, { 17, 64, 20, 240 },
        { 251, 119, 239, 150 } },
    { { 51, 75, 121, 70 }, { 33, 229, 180, 149 }, { 178, 23, 53, 251 },
        { 91, 90, 132, 227 } },
    { { 74, 214, 1, 196 }, { 17, 153, 0, 181 }, { 149, 64, 108, 212 },
        { 252, 230, 44, 55 } },
    { { 201, 79, 20, 255 }, { 30, 122, 19, 41 }, { 29, 156, 174, 72 },
        { 201, 88, 172, 164 } },
    { { 124, 188, 237, 161 }, { 140, 47, 44, 47 }, { 115, 137, 248, 36 },
        { 20, 53, 226, 251 } },
    { { 195, 151, 80, 148 }, { 175, 106, 247, 197 }, { 123, 211, 18, 253 },
        { 81, 150, 106, 106 } },
    { { 135, 45, 111, 186 }, { 167, 126, 218, 122 }, { 191, 176, 109, 163 },
        { 170, 142, 43, 86 } },
    { { 26, 145, 202, 162 }, { 6, 147, 136, 82 }, { 119, 195, 158, 55 },
        { 150, 129, 165, 83 } },
    { { 75, 139, 46, 40 }, { 140, 216, 195, 137 }, { 157, 152, 215, 121 },
        { 102, 239, 56, 239 } },
    { { 85, 164, 65, 169 }, { 116, 65, 245, 60 }, { 198, 86, 192, 199 },
        { 157, 12, 68, 36 } },
    { { 188, 205, 55, 154 }, { 173, 84, 55, 47 }, { 56, 20, 91, 251 },
        { 196, 242, 119, 204 } },
    { { 213, 198, 225, 180 }, { 203, 188, 242, 157 }, { 214, 32, 92, 213 },
        { 31, 120, 240, 113 } },
    { { 99, 196, 29, 208 }, { 239, 235, 49, 255 }, { 156, 98, 201, 219 },
        { 136, 87, 43, 32 } },
    { { 75, 192, 123, 180 }, { 228, 170, 140, 113 }, { 159, 121, 158, 140 },
        { 206, 239, 244, 230 } },
    { { 73, 194, 155, 92 }, { 238, 188, 65, 38 }, { 81, 12, 44, 133 },
        { 251, 130, 7, 211 } },
    { { 225, 19, 205, 113 }, { 231, 128, 69, 35 }, { 144, 67, 219, 20 },
        { 6, 194, 126, 71 } },
    { { 77, 73, 80, 111 }, { 193, 145, 147, 230 }, { 92, 9, 68, 159 },
        { 58, 230, 124, 112 } }
};

Test(aes_key_expansion, basic_1024_key)
{
    aes_key1024_t key =
        "\x18\x45\x85\x39\xba\x87\xac\x6f\x74\x50\x7c\x9c\x32\xe9\x41\x92\xd5"
        "\x37\x1d\x67\x2e\x11\x0e\xc7\x7a\x27\xd8\x04\x03\xf1\x05\x3a\xb6\x02"
        "\xfc\x64\x24\x57\xc3\x62\x4a\x42\x95\x0e\x97\x2f\xdb\x51\x28\x04\x66"
        "\x64\x0b\x41\xbd\x8e\x03\x1b\x57\x57\x46\xb8\xdf\xc6\x02\x02\xe0\xe8"
        "\x0a\x16\xcd\x57\xce\x75\xb2\x09\x35\x6d\xf3\x35\xa8\xd1\x56\x2d\x09"
        "\x3c\x04\x05\xc1\x4f\xf7\x91\xfd\x40\x79\x94\xac\x5a\x9d\x1e\x26\x11"
        "\xd6\xc5\xcc\x4a\x9f\x8b\x3c\x24\x02\x37\x22\x0b\x6d\xb6\xda\x92\x5b"
        "\x03\x81\x5c\x4c\xbd\x7a\xbf\x30\x76";
    aes_expended_key_t round_keys;

    aes_key_expansion(round_keys, AES_1024, key, AES1024_NB_ROUNDS);
    for (int round = 0; round <= AES1024_NB_ROUNDS; round++)
        CHECK_MATRIX_EQUALITY(
            round_keys[round], expected_basic_1024_expended_key[round]);
}